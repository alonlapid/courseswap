create table dbuser 
(
  SID int, 
  dbname nvarchar(256) primary key ,
  FOREIGN KEY (SID) REFERENCES Student(SID)
)

create table Course
(
    Name nvarchar(256),
    CID nvarchar(256) primary key,
    Points real
)

create table Student
(
    SID int primary key, 
    Name  nvarchar(256) 
)

create table Class
(
    CLID  int primary key, 
    CID nvarchar(256) , 
    SemesterName  nvarchar(256) ,
    SemesterYear  int, 
    Instructor nvarchar(256),
    Name nvarchar(256),
    FOREIGN KEY (CID) REFERENCES Course(CID),
    UNIQUE(CID,SemesterName,SemesterYear,Instructor),
    CHECK(SemesterName in ('Fall','Spring','Summer')),
    UNIQUE(Name),
    CHECK(SemesterYear > 2000 and SemesterYear < 3000)
)

create table Lesson 
(
    CLID int ,
    Location nvarchar(256),
    Day char(10) ,
    Hour real,
    LengthInMin int,
    FOREIGN KEY (CLID) REFERENCES Class(CLID),
    UNIQUE(CLID,Day,Hour,Location),
    CHECK(Hour >= 0.0 AND Hour < 24.0),
    CHECK(Day IN ('Sun','Mon','Tue','Wed','Thu','Fri','Sat')),
    CHECK(LengthInMin > 0 and LengthInMin < 120)
)
 
create table Enrollment 
(
    EID int primary key IDENTITY(1,1),
    SID int ,
    CLID int,
    Completed int,
    EnrollmentTime datetime ,
    FOREIGN KEY (SID) REFERENCES Student(SID),
    FOREIGN KEY (CLID) REFERENCES Class(CLID),
    UNIQUE(CLID,SID),
    CHECK(Completed = 0 or  Completed  = 1)
)


create table Prerequisite 
(    
    CID nvarchar(256),
    MUSTCID nvarchar(256),
    primary key (CID,MUSTCID),
    FOREIGN KEY (CID) REFERENCES Course(CID),
    FOREIGN KEY (MUSTCID) REFERENCES Course(CID)
)

create table ExchangeRequest 
(
    RID int primary key IDENTITY(1,1),
    SID int ,
    CLID_Src int,
    CLID_Dest int,
    RequestTime datetime,
    FOREIGN KEY (SID) REFERENCES Student(SID),
    FOREIGN KEY (CLID_Src) REFERENCES Class(CLID),
    FOREIGN KEY (CLID_Dest) REFERENCES Class(CLID)
)

